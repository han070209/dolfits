<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì°©ì¥ ìƒì„¸ | DolFits</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
  <!-- âœ… ë©”ë‰´ -->
  <script src="./menu.js" defer></script>
  <div class="side-menu">
    <ul>
      <li><a href="/">í™ˆ</a></li>
      <li><a href="/request">ì°©ì¥ ìš”ì²­</a></li>
      <li><a href="/date">ë‚ ì§œë³„ ì°©ì¥</a></li>
      <li><a href="/group">ê·¸ë£¹ë³„ ì°©ì¥</a></li>
      <li><a href="/top">ì¸ê¸° ì°©ì¥ ìˆœìœ„</a></li>
      <li><a href="/contact">ë¬¸ì˜</a></li>
    </ul>
  </div>

  <!-- âœ… ë¡œê³  / ê²€ìƒ‰ì°½ -->
  <div class="logo" onclick="window.location.href='/'">DolFits</div>
  <div class="search-bar" id="searchBar">
    <input id="keyword" type="text" placeholder="ê·¸ë£¹ëª… ë˜ëŠ” ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" autocomplete="off">
  </div>
  <ul id="suggestList" class="suggest-box"></ul>

  <!-- âœ… ìƒì„¸ ì˜ì—­ -->
  <main class="fit-detail" id="detailContainer" style="margin-top:180px;"></main>

  <!-- âœ… ìŠ¤í¬ë¦½íŠ¸ -->
  <script src="./menu.js" defer></script>
  <script src="./searchMain.js" defer></script>

  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      const container = document.getElementById("detailContainer");
      const params = new URLSearchParams(window.location.search);
      const file = params.get("file");
      if (!file) return;

      try {
        const res = await fetch(`/data/outfitss.json?t=${Date.now()}`, { cache: "no-store" });
        if (!res.ok) throw new Error("ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨");
        const data = await res.json();
        const fit = data.find(f => f.filename === file);
        if (!fit) {
          container.innerHTML = "<p style='color:#777;'>í•´ë‹¹ ì°©ì¥ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤ ğŸ˜¢</p>";
          return;
        }

        // âœ… í´ë˜ìŠ¤ ê¸°ë°˜ êµ¬ì¡° (CSSë¡œ ì œì–´ ê°€ëŠ¥)
        container.innerHTML = `
          <div class="fit-detail-image">
            <img src="/uploads/${encodeURIComponent(fit.filename)}" alt="${fit.originalname}" />
          </div>
          <div class="fit-detail-info">
            <h2>ì°©ì¥ì •ë³´</h2>
            <ul>
              <li><b>ê·¸ë£¹ëª…:</b> ${fit.groupName || 'ì •ë³´ ì—†ìŒ'}</li>
              <li><b>ì´ë¦„:</b> ${fit.name || 'ì •ë³´ ì—†ìŒ'}</li>
              <li><b>ë‚ ì§œ:</b> ${fit.date || 'ì •ë³´ ì—†ìŒ'}</li>
              ${
                fit.items && fit.items.length > 0
                  ? fit.items.map(i => `<li><b>${i.label || 'í•­ëª©'}:</b> <a href="${i.link}" target="_blank">${i.link}</a></li>`).join('')
                  : '<li><i>ë§í¬ ì •ë³´ ì—†ìŒ</i></li>'
              }
            </ul>
          </div>
        `;
      } catch (err) {
        console.error("âŒ ì°©ì¥ ìƒì„¸ ë¡œë“œ ì˜¤ë¥˜:", err);
        container.innerHTML = "<p style='color:#777;'>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>";
      }

      // ê²€ìƒ‰ ì—”í„° ì‹œ ë©”ì¸ìœ¼ë¡œ ì´ë™
      const keywordInput = document.getElementById("keyword");
      keywordInput.addEventListener("keypress", (e) => {
        if (e.key === "Enter" && keywordInput.value.trim() !== "") {
          const query = encodeURIComponent(keywordInput.value.trim());
          window.location.href = `/index.html?search=${query}`;
        }
      });
    });
  </script>

  <!-- âœ… ëª¨ë°”ì¼ ë°˜ì‘í˜• ì¶”ê°€ -->
  <style>
    @media (max-width: 480px) {
      .fit-detail {
        flex-direction: column;
        align-items: center;
        gap: 30px;
        width: 95%;
        margin: 120px auto 60px;
      }

      .fit-detail-image img {
        width: 90%;
        height: auto;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      }

      .fit-detail-info {
        width: 90%;
        text-align: left;
        font-size: 15px;
        line-height: 1.7;
      }

      .fit-detail-info h2 {
        font-size: 18px;
        margin-bottom: 12px;
      }

      .fit-detail-info li {
        font-size: 14px;
      }
    }
  </style>
  <script src="./lang.js" defer></script>
</body>
</html>
